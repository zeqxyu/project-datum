<!DOCTYPE html>
<html lang="si">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Moj koledar</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js" integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK" crossorigin="anonymous"></script>

	<style>
		.username {
			max-width: 50vw;
			font-weight: 600;
			text-align: center;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			display: inline-block;
			font-size: clamp(0.8rem, 5vw - 0.5rem, 1.4rem); /* Адаптив */
		}
	</style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

</head>
<body data-bs-theme="dark">
	<nav class="navbar bg-dark px-2">
		<!-- Левая кнопка меню -->
		<button class="btn btn-dark" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuOffcanvas">
		  <i class="bi bi-list fs-3"></i>
		</button>
	  
		<!-- Имя пользователя -->
		<div class="mx-auto username">
			<span class="username" id="username">Anton Božič-Matvijenko</span>
		</div>
	  
		<!-- Правая иконка уведомлений -->
		<button class="btn btn-dark" type="button" data-bs-toggle="offcanvas" data-bs-target="#notificationsOffcanvas">
		  <i class="bi bi-bell fs-4"></i>
		</button>
	</nav>
	  
	  <!-- Шторка: Меню -->
	<div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="menuOffcanvas">
		<div class="offcanvas-header d-flex justify-content-between align-items-center">
			<div class="d-flex align-items-center gap-3">
			  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
			  <div class="username" style="max-width: 200px; font-size: clamp(0.8rem, 3vw, 1.2rem); font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
				Anton Božič-Matvijenko
			  </div>
			</div>
			<h5 class="offcanvas-title mb-0">Meni</h5>
		  </div>
		    
		<div class="offcanvas-body d-flex flex-column justify-content-between p-0">
			<div class="list-group list-group-flush">
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3" onclick="window.location.href=''">
					<i class="bi bi-person-circle me-3"></i>
					<span class="flex-grow-1">Moj račun</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center text-warning px-4 py-4">
					<i class="bi bi-coin me-3"></i>
					<span class="flex-grow-1">1675</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center text-warning px-4 py-4">
					<i class="bi bi-braces-asterisk me-3"></i>
					<span class="flex-grow-1">1.37</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3">
					<i class="bi bi-calendar-event me-3"></i>
					<span class="flex-grow-1">Moj koledar</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3">
					<i class="bi bi-clipboard-check me-3"></i>
					<span class="flex-grow-1">Ocenjevanja</span>
					<span class="badge bg-danger rounded-pill">1</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3">
					<i class="bi bi-people me-3"></i>
					<span class="flex-grow-1">Moj razred</span>
				</button>
			</div>
		  
			<div class="list-group list-group-flush mt-3">
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3">
					<i class="bi bi-bug me-3"></i>
					<span class="flex-grow-1">Prijava tehničnih napak</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3">
					<i class="bi bi-code-slash me-3"></i>
					<span class="flex-grow-1">Razvijalci</span>
				</button>
				<button class="list-group-item list-group-item-action d-flex align-items-center px-4 py-3 text-danger">
					<i class="bi bi-box-arrow-right me-3"></i>
					<span class="flex-grow-1">Odjava</span>
				</button>
			</div>
		</div>	  
	</div>
	
	<!-- Шторка: Уведомления -->
	<div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="notificationsOffcanvas">
		<div class="offcanvas-header">
		<h5 class="offcanvas-title">Obvestila</h5>
			<button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
		</div>
		<div class="offcanvas-body p-0">
			<div class="list-group list-group-flush"> 
				<!-- ВАЖНОЕ + переход -->
				<button class="list-group-item list-group-item-action bg-warning text-dark px-4 py-3 border-0" onclick="window.location.href='/ocene'">
					<div class="small text-secondary mb-1">
						25. 7. 2025, 17:00
					</div>
					<div class="d-flex align-items-center">
						<i class="bi bi-shuffle me-3 fs-5"></i>
						<div class="flex-grow-1">Aleks želi zamenjati z vami datum</div>
					</div>
				</button>
				<!-- НЕВАЖНОЕ (просто панель) -->
				<div class="list-group-item bg-dark text-white px-4 py-3 border-0">
					<div class="small text-secondary mb-1">25. 7. 2025, 14:23</div>
					<div class="d-flex align-items-center">
						<i class="bi bi-info-circle me-3 fs-5"></i>
						<div class="flex-grow-1">Vaš pravičnostni koeficient: 1.04 -> 1.37</div>
					</div>
				</div>
			
				<!-- ВАЖНОЕ + переход -->
				<button class="list-group-item list-group-item-action bg-primary text-light px-4 py-3 border-0" onclick="window.location.href='/razpored'">
					<div class="small text-secondary-emphasis mb-1">25. 7. 2025, 11:42</div>
					<div class="d-flex align-items-center">
						<i class="bi bi-calendar-week me-3 fs-5"></i>
						<div class="flex-grow-1">
							Novo ustno ocenjevanje iz MAT! Izberite datum!
						</div>
					</div>
				</button>

				<button class="list-group-item list-group-item-action bg-primary text-light px-4 py-3 border-0" onclick="window.location.href='/razpored'">
					<div class="small text-secondary-emphasis mb-1">25. 7. 2025, 9:31</div>
					<div class="d-flex align-items-center">
						<i class="bi bi-calendar-week me-3 fs-5"></i>
						<div class="flex-grow-1">Datumi za ANG so ovrednoteni! Kupite zdaj!</div>
					</div>
				</button>
			
			</div>
		</div>
	</div>
	
	<!-- СЮДА ВСЕ МЯСО -->

    <style>
        #calendarGrid .col {
          width: 20%;
          max-width: 20%;
        }
        .dot {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          margin: 2px auto 0;
        }
      </style>

    
    <div class="">
        <h1>Prvo ustno ocenjevanje iz matematike</h1>
        <h3 class="text-secondary-emphasis">MATUST1</h3>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <button id="prevMonth" class="btn btn-outline-light">&lt;</button>
        <h4 id="currentMonth" class="mb-0"></h4>
        <button id="nextMonth" class="btn btn-outline-light">&gt;</button>
    </div>
    
    <div class="row row-cols-5 g-2" id="calendarGrid"></div>
    
      <!-- Bottom Sheet -->
      <!-- Offcanvas снизу -->
<div class="offcanvas offcanvas-bottom" tabindex="-1" id="dayDetails" aria-labelledby="dayDetailsLabel" style="height: 300px;">
    <div class="offcanvas-header">
      <h5 id="dayDetailsLabel">Izbrani dan</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body" id="selectedStudentsList" style="overflow-y:auto;">
      <!-- Тут JS вставит список -->
    </div>
  </div>
    
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
      

    <script>
        // MATUST1 podatki
const MATUST1 = {
	MATUST1_01: { date: "03.02", student: "Manca Bizjak" },
	MATUST1_02: { date: "03.02", student: "Blaž Marinšek" },
	MATUST1_03: { date: "03.02", student: "David Mlinar" },
	MATUST1_04: { date: "05.02", student: "Sara Kralj" },
	MATUST1_05: { date: "05.02", student: "Tjaša Dolenc" },
	MATUST1_06: { date: "05.02", student: "Barbara Korošec" },
	MATUST1_07: { date: "06.02", student: "Miha Zajc" },
	MATUST1_08: { date: "06.02", student: "Gregor Kavčič" },
	MATUST1_09: { date: "06.02", student: "Simona Hribar" },
	MATUST1_10: { date: "10.02", student: "Ines Cankar" },
	MATUST1_11: { date: "10.02", student: "Rok Kralj" },
	MATUST1_12: { date: "10.02", student: "Nina Mlakar" },
	MATUST1_13: { date: "12.02", student: "Tilen Oblak" },
	MATUST1_14: { date: "12.02", student: "Jure Pahor" },
	MATUST1_15: { date: "12.02", student: "Lovro Štrukelj" },
	MATUST1_16: { date: "13.02", student: "Katarina Rupnik" },
	MATUST1_17: { date: "13.02", student: "Nejc Lah" },
	MATUST1_18: { date: "13.02", student: "Ana Novak" },
	MATUST1_19: { date: "17.02", student: "Petra Vidmar" },
	MATUST1_20: { date: "17.02", student: "Tina Knez" },
	MATUST1_21: { date: "17.02", student: "Marko Kovač" },
	MATUST1_22: { date: "19.02", student: "Matej Potočnik" },
	MATUST1_23: { date: "19.02", student: "Luka Horvat" },
	MATUST1_24: { date: "19.02", student: "Andrej Turk" },
	MATUST1_25: { date: "20.02", student: "Tamara Bizjak" },
	MATUST1_26: { date: "20.02", student: "Maja Zupan" },
	MATUST1_27: { date: "20.02", student: null },
	MATUST1_28: { date: "24.02", student: "Jan Rozman" },
	MATUST1_29: { date: "24.02", student: null },
	MATUST1_30: { date: "24.02", student: null }
};

const calendarGrid = document.getElementById("calendarGrid");
const currentMonthLabel = document.getElementById("currentMonth");
const prevBtn = document.getElementById("prevMonth");
const nextBtn = document.getElementById("nextMonth");
const modalBody = document.getElementById("selectedStudentsList");

const months = ["Januar", "Februar", "Marec", "April", "Maj", "Junij", "Julij", "Avgust", "September", "Oktober", "November", "December"];

const startYear = 2025;
const startMonth = 8;
const endYear = 2026;
const endMonth = 5;

let currentDate = new Date(startYear, startMonth);

function groupByDate(data) {
	const map = {};
	for (const key in data) {
		const { date, student } = data[key];
		if (!map[date]) map[date] = [];
		map[date].push(student);
	}
	return map;
}

const grouped = groupByDate(MATUST1);

function renderCalendar(date) {
	const year = date.getFullYear();
	const month = date.getMonth();
	if (year < startYear || (year === startYear && month < startMonth)) return;
	if (year > endYear || (year === endYear && month > endMonth)) return;

	currentMonthLabel.textContent = months[month] + " " + year;
	calendarGrid.innerHTML = "";

	const firstDay = new Date(year, month, 1);
	const lastDay = new Date(year, month + 1, 0);
	const start = new Date(firstDay);
	const offset = (start.getDay() + 6) % 7;
	start.setDate(start.getDate() - offset);
	const end = new Date(lastDay);
	end.setDate(end.getDate() + (5 - ((end.getDay() + 6) % 7)));

	let current = new Date(start);
	while (current <= end) {
		if (current.getDay() !== 0 && current.getDay() !== 6) {
			const col = document.createElement("div");
			col.className = "col";

			const cell = document.createElement("div");
			cell.className = "border rounded p-2 text-center position-relative";
			cell.style.minHeight = "60px";

			const label = document.createElement("small");
			label.className = "position-absolute top-0 start-0 m-1 text-muted";
			label.textContent = current.getDate();
			cell.appendChild(label);

			const mmdd = ("0" + current.getDate()).slice(-2) + "." + ("0" + (current.getMonth() + 1)).slice(-2);
			if (current.getMonth() === 1 && grouped[mmdd]) { // февраль
				grouped[mmdd].forEach((student, idx) => {
					const dot = document.createElement("div");
					dot.className = "position-absolute";
					dot.style.right = "4px";
					dot.style.top = `${4 + idx * 10}px`;
					dot.style.width = "6px";
					dot.style.height = "6px";
					dot.style.borderRadius = "50%";
					dot.style.backgroundColor = student ? "#0d6efd" : "white";
					cell.appendChild(dot);
				});
			}

			cell.addEventListener("click", () => {
				const students = current.getMonth() === 1 ? grouped[mmdd] || [] : [];
				modalBody.innerHTML = "";
				students.forEach((s, i) => {
					const p = document.createElement("div");
					p.textContent = `${i + 1}. ${s ? s : "-"}`;
					modalBody.appendChild(p);
				});
				const modal = new bootstrap.Offcanvas(document.getElementById("dayDetails"));
				modal.show();
			});

			col.appendChild(cell);
			calendarGrid.appendChild(col);
		}
		current.setDate(current.getDate() + 1);
	}
}

prevBtn.addEventListener("click", () => {
	currentDate.setMonth(currentDate.getMonth() - 1);
	renderCalendar(currentDate);
});

nextBtn.addEventListener("click", () => {
	currentDate.setMonth(currentDate.getMonth() + 1);
	renderCalendar(currentDate);
});

renderCalendar(currentDate);


cell.addEventListener("click", () => {
  const students = current.getMonth() === 1 ? grouped[mmdd] || [] : [];

  // Массив дней недели по-словенски, понедельник - "Po"
  const dayNames = ["Po", "To", "Sr", "Če", "Pe", "So", "Ne"];
  // День недели для current.getDay() (0 - вс, 1 - пн, ...)
  // Приводим к понедельнику=0: (day + 6) % 7
  const dayOfWeekShort = dayNames[(current.getDay() + 6) % 7];

  const offcanvasTitle = document.getElementById("dayDetailsLabel");
  offcanvasTitle.textContent = `${mmdd} (${dayOfWeekShort})`;

  const modalBody = document.getElementById("selectedStudentsList");
  modalBody.innerHTML = "";

  if (students.length === 0) {
    modalBody.textContent = "Ni vpisanih študentov za ta dan.";
  } else {
    students.forEach((s, i) => {
      const p = document.createElement("div");
      p.textContent = `${i + 1}. ${s ? s : "-"}`;
      modalBody.appendChild(p);
    });
  }

  // Показываем шторку
  const modal = new bootstrap.Offcanvas(document.getElementById("dayDetails"));
  modal.show();
});

    </script>

    <script>

    </script>
	<!-- JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</body>
</html>